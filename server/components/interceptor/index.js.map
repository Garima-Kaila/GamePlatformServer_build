{"version":3,"sources":["../../../../server/components/interceptor/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["/**\n * Session manager\n */\n\n'use strict';\n\nimport * as logger from '../logger';\n\nexport function preGameRequest(req, res,next){\n    logger.log(0,\"Interceptor\",\"managePreGameRequest\",JSON.stringify(req.body));\n    req.Game = {};\n    req.Game.game = req.body.game;\n    req.Game.action = req.body.action;\n    req.Game.bet = req.body.bet ? parseFloat(req.body.bet) : 0;\n    req.Game.betLevel = req.body.betLevel;\n    req.Game.userId = req.body.userID;\n    req.Game.rawReq = req.body;\n    \n    next();\n}\nexport function postGameRequest(req, res,next){\n    logger.log(0,\"Interceptor\",\"managePostGameRequest\",req.Game);\n\n    req.GameOutcome = req.Game.gameResponse;\n    req.GameOutcome.balance = req.Game.wallet.balance;\n    req.GameOutcome.currency = req.Game.wallet.currency;\n    \n    if(req.Game.restore){\n        req.GameOutcome.restore = req.Game.restore;\n        req.GameOutcome.lastOutcome = req.Game.lastOutcome;\n    }\n    \n    delete req.Game;\n    logger.log(0,\"Interceptor\",\"managePostGameRequest\",\"cleanup\");\n    next();\n}\n\n\nexport function preGameResponse(req, res,next){\n    logger.log(0,\"Interceptor\",\"preGameResponse\");\n    // todo: need to see if it is required to tell execution server that it is restore mode\n    /*\n    if(req.Game.restore){\n        req.Game.rawReq.restore = req.Game.restore;\n        req.Game.rawReq.lastOutcome = req.Game.lastOutcome;\n    }\n    */\n    next();\n}\nexport function postGameResponse(req, res,next){\n    logger.log(0,\"Interceptor\",\"postGameResponse\");\n    req.Game.win = req.Game.gameResponse.win ? parseFloat(req.Game.gameResponse.win) : 0;\n    req.Game.roundOver = req.Game.gameResponse.roundOver;\n    req.Game.symbols = req.Game.gameResponse.symbols;\n    req.Game.betlines = req.Game.gameResponse.betlines;\n    next();\n}"]}