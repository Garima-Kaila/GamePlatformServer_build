{"version":3,"sources":["../../../../server/components/wallet/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["/**\n * Wallet manager\n */\n\n'use strict';\n\nimport * as walletController from '../../api/wallet/wallet.controller' ;\nimport constants from '../../constants';\nimport * as logger from '../logger';\n\nexport function managePreGameRequest(req, res,next){\n    logger.log(0,\"Wallet\",\"managePreGameRequest\");\n    \n    // if game request is triggered first time then load initial balance and currency\n    if(req.Game.action===\"init\"){\n        walletController.createIfNotExists({\n            userId : req.Game.userId,\n            balance : parseInt(GLOBAL.config[constants.configurationKeys.defaultBalanceForDemoPlay]),\n            currency : GLOBAL.config[constants.configurationKeys.defaultCurrency]\n        },function(err,walletResponse){\n            if(err){\n                \n            }else{\n                if(!req.Game.wallet){\n                    req.Game.wallet={};\n                    req.Game.wallet.balance = walletResponse.balance;\n                    req.Game.wallet.currency = walletResponse.currency;\n                }\n                next();\n            }\n            \n        });\n    }\n    if(req.Game.action===\"spin\" || req.Game.action===\"deal\" ){\n        walletController.placeBet({\n            userId:req.Game.userId,\n            bet:req.Game.bet\n        },function(err,walletResponse){\n            if(err){\n                \n            }else{\n                if(!req.Game.wallet){\n                    req.Game.wallet={};\n                    req.Game.wallet.balance = walletResponse.balance;\n                    req.Game.wallet.currency = walletResponse.currency;\n                }\n                next();\n            }\n        })\n    }\n    if(req.Game.action===\"draw\"){\n        walletController.getWalletOfUser(req.Game.userId,function(err,walletResponse){\n            if(err){\n                \n            }else{\n                if(!req.Game.wallet){\n                    req.Game.wallet={};\n                    req.Game.wallet.balance = walletResponse.balance;\n                    req.Game.wallet.currency = walletResponse.currency;\n                }\n                next();\n            }\n        })\n    }\n}\nexport function managePostGameRequest(req, res,next){\n    logger.log(0,\"Wallet\",\"managePostGameRequest\");\n     walletController.addWin({\n            userId:req.Game.userId,\n            win : req.Game.win\n        },function(err,walletResponse){\n            if(err){\n                \n            }else{\n                if(!req.Game.wallet){\n                    req.Game.wallet={};\n                    req.Game.wallet.balance = walletResponse.balance;\n                    req.Game.wallet.currency = walletResponse.currency;\n                }\n                next();\n            }\n        })\n     \n    \n  // next();\n}\n"]}